# ============================================
# 后端环境变量配置
# 用于本地开发 (Local) 和 Docker 环境
# 复制此文件为 .env 并根据需要修改配置
# ============================================

# ===== 1. 环境基础配置 =====
ENVIRONMENT=local                  # 环境: local, dev, prod
DEBUG=true                       # 调试模式: true, false
LOG_LEVEL=INFO                  # 日志级别: DEBUG, INFO, WARNING, ERROR, CRITICAL
DEMO_MODE=false                  # 演示模式: true, false (开启后禁用管理端高危操作)

# ===== 2. 数据库配置 (PostgreSQL) =====
# Local: localhost | Docker: postgres (Service Name)
POSTGRES_SERVER=localhost
POSTGRES_PORT=5432
POSTGRES_DB=catwiki
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
DB_ECHO=false                     # 是否输出 SQL 日志

# ===== 3. 数据库连接池配置 =====
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ===== 4. 安全配置 =====
# 警告: 生产环境必须修改为强密钥
SECRET_KEY=dev-secret-key-minimum-32-characters-long-for-development-only
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=10080 # Token 过期时间(分钟), 默认 7 天

# ===== 5. CORS 配置 =====
# 允许跨域的源, 多个源用逗号分隔
BACKEND_CORS_ORIGINS=http://localhost:8001,http://localhost:8002,http://admin-frontend:8001,http://client-frontend:8002

# ===== 6. 对象存储配置 (RustFS/S3) =====
# Local: localhost:9000 | Docker: rustfs:9000
RUSTFS_ENDPOINT=rustfs:9000
RUSTFS_ACCESS_KEY=rustfsadmin
RUSTFS_SECRET_KEY=rustfsadmin
RUSTFS_BUCKET_NAME=catwiki
RUSTFS_USE_SSL=false
RUSTFS_REGION=us-east-1

# RustFS Root 用户 (用于服务端初始化)
RUSTFS_ROOT_USER=rustfsadmin
RUSTFS_ROOT_PASSWORD=rustfsadmin

# RustFS 公开访问链接
RUSTFS_PUBLIC_BUCKET=true
RUSTFS_PUBLIC_URL=http://localhost:9000

# ===== 7. AI 服务配置 (OpenAI Compatible) =====
# 注意：当数据库中的 AI 配置为空时，此处设置的环境变量会在启动时自动加载进数据库。
# 如果数据库中已有配置（已在管理后台修改过），则不会从环境变量同步。
# 警告：生产环境请保护好 API Key

## 7.1 Chat 对话配置
# AI_CHAT_API_KEY=sk-your-chat-api-key
# AI_CHAT_API_BASE=https://api.your-chat-service.com/v1
# AI_CHAT_MODEL=your-chat-model

## 7.2 Embedding 向量配置
# AI_EMBEDDING_API_KEY=sk-your-embedding-api-key
# AI_EMBEDDING_API_BASE=https://api.your-embedding-service.com/v1
# AI_EMBEDDING_MODEL=your-embedding-model
# AI_EMBEDDING_DIMENSION=4096
# AI_EMBEDDING_BATCH_SIZE=10               # Embedding API 单次请求批量大小（阿里云限制 10，OpenAI 限制 2048）

## 7.3 Reranker 重排序配置
# AI_RERANK_ENABLE=false
# AI_RERANK_API_KEY=sk-your-reranker-api-key
# AI_RERANK_API_BASE=https://api.your-reranker-service.com/v1
# AI_RERANK_MODEL=your-reranker-model

## 7.4 VL 视觉对话配置 (选填)
# AI_VL_API_KEY=sk-your-vl-api-key
# AI_VL_API_BASE=https://api.your-vl-service.com/v1

# ===== 8. 文档解析服务配置 (DocProcessor) =====

# MINERU_NAME=MinerU
# MINERU_BASE_URL=http://mineru-service:8888
# MINERU_API_KEY=sk-mineru-key
# MINERU_ENABLED=true

# DOCLING_NAME=Docling
# DOCLING_BASE_URL=http://docling-service:8000
# DOCLING_API_KEY=sk-docling-key
# DOCLING_ENABLED=true

# PADDLEOCR_NAME=PaddleOCR
# PADDLEOCR_BASE_URL=http://paddleocr-service:8080
# PADDLEOCR_API_KEY=NONE
# PADDLEOCR_ENABLED=false

# ===== 9. 配置覆盖控制 =====
# 设置为 true 时，每次启动都会用环境变量覆盖数据库中的配置
# FORCE_UPDATE_AI_CONFIG=false
# FORCE_UPDATE_DOC_PROCESSOR=false
