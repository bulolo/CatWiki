# å¿«é€Ÿå¼€å§‹

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨åœ¨ 5 åˆ†é’Ÿå†…å¯åŠ¨ CatWikiï¼ŒåŒ…æ‹¬å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒä¸¤ç§æ–¹å¼ã€‚

## å‰ç½®è¦æ±‚

- **Docker** >= 20.10
- **Docker Compose** >= 2.0
- **Make** (ç³»ç»Ÿè‡ªå¸¦æˆ–é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…)

---

## âš¡ å¼€å‘ç¯å¢ƒ

å¼€å‘ç¯å¢ƒé€‚åˆæœ¬åœ°å¼€å‘è°ƒè¯•ï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼Œæ–¹ä¾¿å¿«é€Ÿè¿­ä»£ã€‚

### ä¸€é”®å¯åŠ¨

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/bulolo/CatWiki.git
cd catWiki

# 2. é¦–æ¬¡å¯åŠ¨ï¼ˆåˆå§‹åŒ–é…ç½®ï¼‰
make dev-init

# 3. ä¿®æ”¹é…ç½® .env (å¯é€‰)

# 4. å¯åŠ¨å¼€å‘ç¯å¢ƒ
make dev-up
```

> [!WARNING]
> **å…³äº `make dev-init`**: å®ƒä¼šé‡æ–°ä»æ¨¡æ¿å¤åˆ¶ `.env` æ–‡ä»¶ï¼Œè¿™ä¼šè¦†ç›–æ‚¨å·²æœ‰çš„é…ç½®ã€‚
> - **ç¬¬ä¸€æ¬¡è¿è¡Œ**: è¯·ä½¿ç”¨ `make dev-init`
> - **åç»­å¼€å‘**: è¯·ç›´æ¥ä½¿ç”¨ `make dev-up`

### è®¿é—®æœåŠ¡

ç­‰å¾… 2-3 åˆ†é’Ÿï¼Œæ‰€æœ‰æœåŠ¡å¯åŠ¨å®Œæˆåï¼Œè®¿é—®ï¼š

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| ğŸ¯ ç®¡ç†åå° | http://localhost:8001 | ä½¿ç”¨ `admin@example.com` / `admin123` ç™»å½• |
| ğŸ’¬ å®¢æˆ·ç«¯ | http://localhost:8002/medical | Demo åŒ»å­¦ç§‘æ™®ï¼ŒåŒ…å« 5 ç¯‡åŒ»å­¦æ–‡æ¡£ |
| ğŸ“š API æ–‡æ¡£ | http://localhost:3000/docs | äº¤äº’å¼ API æ–‡æ¡£ |
| ğŸ“– æ–‡æ¡£ç«™ç‚¹ | http://localhost:8003 | é¡¹ç›®å®Œæ•´æ–‡æ¡£ |

### å¼€å‘ç¯å¢ƒå‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make dev-init` | **åˆå§‹åŒ–ç¯å¢ƒé…ç½®**ï¼šæ¸…ç†å¹¶é‡æ–°ä» `.env.example` å¤åˆ¶é…ç½®æ–‡ä»¶ |
| `make dev-up` | **å¼€å‘å¯åŠ¨**ï¼šæ„å»ºé•œåƒå¹¶åœ¨å‰å°å¯åŠ¨ï¼Œå®æ—¶æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿— |
| `make dev-down` | **ä¼˜é›…åœæ­¢**ï¼šåœæ­¢å¹¶ç§»é™¤å®¹å™¨ï¼Œä¿ç•™æ•°æ®åº“å­˜å‚¨å· |
| `make dev-restart` | **å¿«æ·é‡å¯**ï¼šä»…é‡å¯åç«¯åº”ç”¨å®¹å™¨ |
| `make dev-logs` | **å®æ—¶æ—¥å¿—**ï¼šæŸ¥çœ‹åç«¯æ ¸å¿ƒæœåŠ¡çš„å®æ—¶è¿è¡Œæ—¥å¿— |
| `make dev-db-migrate m="msg"` | **ç”Ÿæˆè¿ç§»è„šæœ¬**ï¼šç”Ÿæˆæ–°çš„æ•°æ®åº“è¿ç§»è„šæœ¬ï¼ˆéœ€æä¾›å¤‡æ³¨ `m`ï¼‰ |
| `make dev-db-psql` | **æ•°æ®åº“ç»ˆç«¯**ï¼šè¿›å…¥ PostgreSQL äº¤äº’å¼ç»ˆç«¯ |
| `make dev-clean` | **æ·±åº¦é‡ç½®**ï¼šåœæ­¢å®¹å™¨å¹¶**åˆ é™¤æ‰€æœ‰æ•°æ®å·**ï¼ˆâš ï¸ å±é™©æ“ä½œï¼‰ |

---

## ğŸš€ ç”Ÿäº§ç¯å¢ƒ

ç”Ÿäº§ç¯å¢ƒé€‚åˆæ­£å¼éƒ¨ç½²ï¼Œä½¿ç”¨ Nginx åå‘ä»£ç†ï¼Œæ”¯æŒ HTTPSï¼Œæ€§èƒ½ä¼˜åŒ–ã€‚

### ä¸€é”®éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/bulolo/CatWiki.git
cd catWiki

# 2. åˆå§‹åŒ–ç”Ÿäº§é…ç½®
make prod-init

# 3. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆå¿…é¡»ï¼ï¼‰
vim deploy/docker/.env.backend    # åç«¯é…ç½®
vim deploy/docker/.env.admin      # Admin å‰ç«¯é…ç½®
vim deploy/docker/.env.client     # Client å‰ç«¯é…ç½®

# 4. åå°å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
make prod-up
```

### å¿…è¦é…ç½®é¡¹

> [!IMPORTANT]
> ç”Ÿäº§ç¯å¢ƒ**å¿…é¡»**ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å­˜åœ¨å®‰å…¨é£é™©ï¼

#### åç«¯é…ç½® (`deploy/docker/.env.backend`)

```bash
# æ•°æ®åº“å¯†ç ï¼ˆå¿…æ”¹ï¼‰
POSTGRES_PASSWORD=your_secure_password

# JWT å¯†é’¥ï¼ˆå¿…æ”¹ï¼Œä½¿ç”¨éšæœºå­—ç¬¦ä¸²ï¼‰
SECRET_KEY=your_random_secret_key_at_least_32_chars

# CORS å…è®¸çš„åŸŸå
BACKEND_CORS_ORIGINS=["https://admin.your-domain.com","https://client.your-domain.com"]

# RustFS å¯¹è±¡å­˜å‚¨é…ç½®
RUSTFS_ENDPOINT=rustfs:9000                    # å†…éƒ¨è®¿é—®åœ°å€
RUSTFS_ACCESS_KEY=rustfsadmin                  # è®¿é—®å¯†é’¥ï¼ˆå»ºè®®ä¿®æ”¹ï¼‰
RUSTFS_SECRET_KEY=rustfsadmin                  # å¯†é’¥ï¼ˆå»ºè®®ä¿®æ”¹ï¼‰
RUSTFS_PUBLIC_URL=https://oss.your-domain.com  # å…¬ç½‘è®¿é—®åœ°å€
```

#### å‰ç«¯é…ç½®

```bash
# deploy/docker/.env.admin
NEXT_PUBLIC_API_URL=https://api.your-domain.com
NEXT_PUBLIC_CLIENT_URL=https://client.your-domain.com  # Client å‰ç«¯åœ°å€ï¼Œç”¨äº AI é—®ç­”è·³è½¬

# deploy/docker/.env.client
NEXT_PUBLIC_API_URL=https://api.your-domain.com
NEXT_PUBLIC_DOCS_URL=https://docs.your-domain.com
```

### è®¿é—®æœåŠ¡

| æœåŠ¡ | é»˜è®¤ç«¯å£ | è¯´æ˜ |
|------|----------|------|
| ğŸ¯ ç®¡ç†åå° | 8001 | å»ºè®®é…ç½®åŸŸåï¼š`admin.your-domain.com` |
| ğŸ’¬ å®¢æˆ·ç«¯ | 8002 | å»ºè®®é…ç½®åŸŸåï¼š`app.your-domain.com` |
| ğŸ“š API | 3000 | å»ºè®®é…ç½®åŸŸåï¼š`api.your-domain.com` |
| ğŸ“– æ–‡æ¡£ | 8003 | å»ºè®®é…ç½®åŸŸåï¼š`docs.your-domain.com` |

### ç”Ÿäº§ç¯å¢ƒå‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make prod-init` | **ç”Ÿäº§åˆå§‹åŒ–**ï¼šåˆå§‹åŒ–ç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶æ¨¡æ¿ |
| `make prod-up` | **ç”Ÿäº§å¯åŠ¨**ï¼šåœ¨åå°å¯åŠ¨ç”Ÿäº§ç¯å¢ƒæ‰€æœ‰æœåŠ¡ |
| `make prod-down` | **ç”Ÿäº§åœæ­¢**ï¼šåœæ­¢å¹¶ç§»é™¤ç”Ÿäº§ç¯å¢ƒå®¹å™¨ |
| `make prod-restart` | **é‡å¯åç«¯**ï¼šä»…é‡å¯ç”Ÿäº§ç¯å¢ƒåç«¯åº”ç”¨å®¹å™¨ |
| `make prod-logs` | **å®æ—¶æ—¥å¿—**ï¼šæŸ¥çœ‹ç”Ÿäº§ç¯å¢ƒå®¹å™¨æ—¥å¿— |
| `make prod-clean` | **æ·±åº¦é‡ç½®**ï¼šåœæ­¢å®¹å™¨å¹¶**åˆ é™¤ç”Ÿäº§æ‰€æœ‰æ•°æ®å·**ï¼ˆâš ï¸ å±é™©æ“ä½œï¼‰ |

---

## ğŸ”§ é€šç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make gen-sdk` | **ç”Ÿæˆ SDK**ï¼šè§¦å‘åç«¯ API è‡ªåŠ¨ç”Ÿæˆå‰ç«¯ SDK |
| `make help` | **é¢„è§ˆå‘½ä»¤**ï¼šæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨æŒ‡ä»¤åŠå…¶è¯´æ˜ |

---

## ğŸ“š ä¸‹ä¸€æ­¥

- ğŸ“– [ç¯å¢ƒé…ç½®æŒ‡å—](/deployment/config/environment) - è¯¦ç»†çš„é…ç½®è¯´æ˜
- ğŸš€ [Docker éƒ¨ç½²æŒ‡å—](/deployment/guide/docker) - å®Œæ•´ç”Ÿäº§éƒ¨ç½²æµç¨‹
- ğŸ”Œ [API æ–‡æ¡£](/development/api/overview) - API æ¥å£è¯´æ˜
- ğŸ’» [åç«¯å¼€å‘æŒ‡å—](/development/guide/backend) - åç«¯å¼€å‘æŒ‡å—

---

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆç®¡ç†åå°ç™»å½•ä¸ä¸Šï¼Ÿ

A: è¯·ç¡®è®¤æ˜¯å¦è¿è¡Œäº† `make dev-init`ï¼ˆå¼€å‘ï¼‰æˆ– `make prod-init`ï¼ˆç”Ÿäº§ï¼‰ã€‚å¦‚æœæ•°æ®åº“å·²æŸåï¼Œè¯·ä½¿ç”¨å¯¹åº”çš„ `clean` å‘½ä»¤é‡ç½®ã€‚

### Q: å¦‚ä½•ä¿®æ”¹é»˜è®¤æœåŠ¡ç«¯å£ï¼Ÿ

A: 
- å¼€å‘ç¯å¢ƒï¼šä¿®æ”¹æ ¹ç›®å½•çš„ `docker-compose.dev.yml`
- ç”Ÿäº§ç¯å¢ƒï¼šä¿®æ”¹ `deploy/docker/docker-compose.prod.yml`

### Q: å®¢æˆ·ç«¯ API æŠ¥ 404ï¼Ÿ

A: ç¡®ä¿è®¿é—®è·¯å¾„åŒ…å«ç«™ç‚¹åŸŸååç¼€ï¼Œä¾‹å¦‚ï¼š`http://localhost:8002/medical`ã€‚

### Q: ä¿®æ”¹é…ç½®åä¸ç”Ÿæ•ˆï¼Ÿ

A: Docker ç¯å¢ƒéœ€è¦é‡å¯æœåŠ¡ï¼š
- å¼€å‘ç¯å¢ƒï¼š`make dev-restart` æˆ– `make dev-down && make dev-up`
- ç”Ÿäº§ç¯å¢ƒï¼š`make prod-restart` æˆ– `make prod-down && make prod-up`

### Q: ç”Ÿäº§ç¯å¢ƒå¦‚ä½•é…ç½® HTTPSï¼Ÿ

A: å»ºè®®ä½¿ç”¨ Nginx åå‘ä»£ç† + Let's Encryptï¼Œè¯¦è§ [Docker éƒ¨ç½²æŒ‡å—](/deployment/guide/docker)ã€‚

æ›´å¤šé—®é¢˜è¯·æŸ¥çœ‹ [å¸¸è§é—®é¢˜](/about/project/faq)ã€‚
